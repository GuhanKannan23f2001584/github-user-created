<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub User Creation Date</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous" defer></script>
    <style>
        body {
            background-color: #f8f9fa;
        }
        .container {
            max-width: 600px;
        }
        #result-card {
            min-height: 100px;
        }
        .display-6 {
            font-weight: 300;
            color: #0d6efd;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <div class="card shadow-sm">
            <div class="card-body p-4 p-md-5">
                <h1 class="card-title text-center mb-3">GitHub Account Age</h1>
                <p class="text-center text-muted mb-4">Enter a GitHub username to see when their account was created.</p>
                
                <form id="github-user-abc123" class="mb-4">
                    <div class="input-group">
                        <input type="text" class="form-control form-control-lg" id="username" placeholder="e.g., octocat" required aria-label="GitHub Username">
                        <button class="btn btn-primary" type="submit" id="submit-button">Fetch</button>
                    </div>
                </form>

                <div id="github-status" class="visually-hidden" aria-live="polite" aria-atomic="true"></div>
                <div id="feedback" class="mb-3"></div>

                <div id="result-card" class="card bg-light">
                    <div class="card-body text-center d-flex flex-column justify-content-center">
                        <h5 class="card-title text-secondary">Account Created On</h5>
                        <p class="display-6 m-0" id="github-created-at"></p>
                    </div>
                </div>

            </div>
        </div>
        <footer class="text-center text-muted mt-4">
            <small>A simple GitHub API utility.</small>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('github-user-abc123');
            const usernameInput = document.getElementById('username');
            const createdAtElement = document.getElementById('github-created-at');
            const feedbackElement = document.getElementById('feedback');
            const submitButton = document.getElementById('submit-button');
            const statusElement = document.getElementById('github-status');

            const getApiToken = () => {
                const urlParams = new URLSearchParams(window.location.search);
                return urlParams.get('token');
            };

            const displayFeedback = (message, isError = false) => {
                feedbackElement.innerHTML = `<div class="alert ${isError ? 'alert-danger' : 'alert-info'}" role="alert">${message}</div>`;
                if (isError) {
                    createdAtElement.textContent = 'N/A';
                }
            };

            const clearFeedback = () => {
                feedbackElement.innerHTML = '';
            };
            
            const fetchGitHubUser = async (username) => {
                if (!username) return;

                submitButton.disabled = true;
                submitButton.innerHTML = `<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Fetching...`;
                clearFeedback();
                createdAtElement.textContent = '';
                statusElement.textContent = `Looking up user ${username}.`;

                const token = getApiToken();
                const headers = {
                    'Accept': 'application/vnd.github.v3+json',
                };
                if (token) {
                    headers['Authorization'] = `Bearer ${token}`;
                }

                try {
                    const response = await fetch(`https://api.github.com/users/${username}`, { headers });

                    if (!response.ok) {
                        let errorMessage = `Error: ${response.status} ${response.statusText}`;
                        if (response.status === 404) {
                            errorMessage = `User '${username}' not found.`;
                        } else if (response.status === 403) {
                            errorMessage = 'API rate limit exceeded. Please try again later or use a token via ?token=YOUR_TOKEN in the URL.';
                        }
                        throw new Error(errorMessage);
                    }

                    const data = await response.json();
                    const createdAt = new Date(data.created_at);
                    const formattedDate = createdAt.toISOString().split('T')[0] + ' UTC';
                    
                    createdAtElement.textContent = formattedDate;
                    statusElement.textContent = `Lookup successful for ${username}. Account created on ${formattedDate}.`;

                } catch (error) {
                    displayFeedback(error.message, true);
                    statusElement.textContent = `Lookup failed for ${username}. ${error.message}`;
                } finally {
                    submitButton.disabled = false;
                    submitButton.textContent = 'Fetch';
                }
            };

            form.addEventListener('submit', (event) => {
                event.preventDefault();
                const username = usernameInput.value.trim();
                fetchGitHubUser(username);
            });

            fetchGitHubUser('octocat');
        });
    </script>
</body>
</html>